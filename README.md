# Usage

帮同学写的，顺便po到github上。

## 准备工作

0. 环境：python3.6

1. 安装以下库：openpyxl/selenium/urllib

   在pycharm下安装、使用虚拟环境、直接安装均可，会用就行。

2. windows系统中，将chromedriver.exe放置任一PATH（环境变量）路径下

3. 在main.py中输入起始时间(pretime)和结束时间(afttime)

4. 在main.py中输入微博账号和密码

## 使用注意事项

0. 搜索使用的关键词使用了二次url编码，我测试了一下一次编码后的搜索结果不太一样，较两次编码的url内容上要稀疏一些。


1. 运行时会首先询问搜索关键词，然后在main.py同一目录下生成"关键词.xlsx"文件，若已有同名文件，则按照此脚本的生成方式进行读取：

   ```
   第一列：日期
   第二列：时间
   第三列：作者
   第四列：性别
   第五列：地址
   第六列：内容
   ```

   格式不对会报错。

2. 若有同名文件且符合格式，则会按照已爬取到的最新的时间开始爬取（之前的会跳过），不用担心重复。

3. 由于是模拟浏览器行为，在连续爬取40页左右时新浪会跳出验证码（如截图所示），此时脚本会等待60000秒，在这段时间内输入验证码后，脚本会立刻继续执行。超出时间则报错。
